<!DOCTYPE html>
<html>
<head>
  <title>Task Manager – No Firebase</title>
  <style>
    body { font-family: Arial; background: #f5f5f5; display: flex; justify-content: center; align-items: center; height: 100vh; transition: background 0.3s,color 0.3s;}
    body.dark{background:#1e1e2f;color:white;}
    .box{background:linear-gradient(135deg,#43e97b,#38f9d7);padding:20px;border-radius:10px;width:380px;text-align:center;color:#1e1e2f;}
    body.dark .box{color:white;background:linear-gradient(135deg,#2b2b3c,#44445a);}
    input,select{width:78%;padding:6px;margin:4px 0;border-radius:5px;border:1px solid #333;}
    body.dark input,body.dark select{color:white;background:#333;border:1px solid #fff;}
    button{padding:5px 10px;margin:3px;border:none;border-radius:5px;cursor:pointer;}
    li{display:flex;justify-content:space-between;align-items:center;margin-top:8px;}
    li.completed{text-decoration:line-through;color:gray;}
    li.overdue{color:red;font-weight:bold;}
    #darkToggle{margin-top:10px;background:#222;color:white;}
  </style>
</head>
<body>

<div class="box">
  <h2>Task Manager</h2>

  <input id="taskInput" placeholder="Enter task"><br>
  <select id="categorySelect">
    <option>Work</option>
    <option>Study</option>
    <option>Personal</option>
  </select><br>

  <input type="date" id="dueDate"><br>
  <button onclick="addTask()">Add Task</button>

  <input id="searchInput" placeholder="Search..." oninput="renderTasks()">

  <div>
    <button onclick="setFilter('all')">All</button>
    <button onclick="setFilter('completed')">Completed</button>
    <button onclick="setFilter('pending')">Pending</button>
  </div>

  <ul id="taskList"></ul>
  <div id="counter"></div>

  <button id="darkToggle" onclick="toggleDark()">Toggle Dark Mode</button>
</div>

<script>
let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
let filter = "all";

function saveTasks(){
  localStorage.setItem("tasks", JSON.stringify(tasks));
}

function addTask(){
  const text = taskInput.value;
  if(!text) return;

  tasks.push({
    text,
    category: categorySelect.value,
    dueDate: dueDate.value,
    completed:false
  });

  taskInput.value="";
  dueDate.value="";
  saveTasks();
  renderTasks();
}

function renderTasks(){
  taskList.innerHTML="";
  const today = new Date().toISOString().split("T")[0];
  let completedCount=0;

  tasks.forEach((task,i)=>{
    if(filter==="completed" && !task.completed) return;
    if(filter==="pending" && task.completed) return;
    if(!task.text.toLowerCase().includes(searchInput.value.toLowerCase())) return;

    const li=document.createElement("li");
    li.innerText=`[${task.category}] ${task.text} (${task.dueDate||"No date"})`;

    if(task.completed){li.classList.add("completed");completedCount++;}
    else if(task.dueDate && task.dueDate<today) li.classList.add("overdue");

    li.onclick=()=>{task.completed=!task.completed; saveTasks(); renderTasks();}

    const del=document.createElement("button");
    del.innerText="❌";
    del.onclick=(e)=>{e.stopPropagation(); tasks.splice(i,1); saveTasks(); renderTasks();}

    li.appendChild(del);
    taskList.appendChild(li);
  });

  counter.innerText=`Total: ${tasks.length} | Completed: ${completedCount}`;
}

function setFilter(val){filter=val; renderTasks();}
function toggleDark(){document.body.classList.toggle("dark");}

renderTasks();
</script>

</body>
</html>
